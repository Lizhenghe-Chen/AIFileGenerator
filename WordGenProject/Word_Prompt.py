"""
Word文档生成相关的提示词模板
"""
from typing import Optional


def get_agent_system_prompt() -> str:
    """获取AI代理的系统提示词"""
    return """你是一个专业的教育内容生成助手，擅长根据提供的知识内容创建高质量的教学材料。"""

def get_word_generation_prompt(learning_content: str, user_requirements: Optional[str] = None) -> str:
    """获取Word内容生成的提示词"""
    return f"""
请根据用户的需求分析并生成一份教学工作表的内容，要求学生掌握的内容知识点：{learning_content}

要求：
1. 内容要准确、专业、适合教学使用,不要口語化，严格按照内容知识点内容生成
2. 选择题要有合理的选项和正确答案，并必要时根据用户需求提供多选或单选
3. 简答题的答案要点要清晰明确
4. 学习重点要突出关键概念
5. 教学建议要实用可行
6. 所有内容要与用户需求主题相关
7. 确保JSON格式完整正确，不要有语法错误；特别注意转义字符，如反斜杠在LaTeX公式中必须使用双反斜杠（\\\\）表示
8. 严格根据{learning_content}的语言，使用相同的语言生成所有文本内容（例如，如果是粤语，则使用正式的、非口语化的粤语表达方式；如果是英文，则使用英文；如果是繁体中文，则使用繁体中文）；不要切换或混合语言
9. 公式使用LaTeX格式，确保数学公式清晰可读，括号使用双斜杠（\\\\left( 和 \\\\right) 等）；用户要求需要有公式考核，因此在quiz_data或问题中加入相关LaTeX公式示例（如数学表达或适配内容的相关公式）
10. 验证生成的JSON是否可解析，避免Invalid \\escape错误

请你注意用户的额外需求：{user_requirements}

请直接返回JSON格式的内容，不要添加其他说明文字。
请确保内容专业、准确，并符合教育领域的标准。

请按照以下JSON格式返回，不要有中文标点符号在json格式中。对应的内容为参考，请你根据用户的需求生成相应的内容：
{{
    "theme": "文档主题标题",
    "topic": "具体主题内容",
    "learning_focus": "学习重点内容",
    "learning_outcome": "学习成果描述",
    "teaching_suggestions": [ # 教学建议列表，可以包含多个建议，尽量具体，不要过于笼统和简洁
        "教学建议1",
        "教学建议2", 
        "教学建议3",
        ... # 可以根据需要添加更多建议
    ],
    "worksheet_title": "工作表标题",
    "quiz_data": [ # 这些内容必须是需要学习掌握的知识点内容，直接照搬，必要时提供公式和示例
        "学习内容片段1",
        "学习内容片段2",
        "学习内容片段3",
        ... # 可以根据需要添加更多内容
    ],
    "answer": "综合答案或总结性内容",
    "multiple_choice": [ #注意根据用户需求生成单选或多选题，题目数量可以调整，不用带编号或字母
        {{
            "q": "选择题题目1",
            "choices": ["选项A", "选项B", "选项C", "选项D", ...],
            "correct": [0, 1, 2, ...] 
        }},
        {{
            "q": "选择题题目2",
            "choices": ["选项A", "选项B", "选项C", "选项D", ...],
            "correct": [1, 2, 3, ...]
        }},
        {{
            "q": "选择题题目3",
            "choices": ["选项A", "选项B", "选项C", "选项D", ...],
            "correct": [0, 1, 3, ...]
        }}
    ],
    "short_answer_questions": [ # 简答题可以调整数量和内容
        {{
            "q": "简答题题目1",
            "a": [
                "答案要点1",
                "答案要点2", 
                "答案要点3",
                "答案要点4"
            ]
        }},
        {{
            "q": "简答题题目2",
            "a": [
                "答案要点1",
                "答案要点2",
                "答案要点3"
            ]
        }}
    ],
    "filename": "建议的文件名（不包含.docx扩展名）"
}}


"""
