"""
Word文檔生成相關嘅提示詞模板
"""
from typing import Optional


def get_agent_system_prompt() -> str:
    """獲取AI代理嘅系統提示詞"""
    return """您是一位專業的教育內容生成助手，擅長根據提供的知識內容創作高品質的教學材料。"""

def get_word_generation_prompt(learning_content: str, user_requirements: Optional[str] = None) -> str:
    """獲取Word內容生成嘅提示詞"""
    return f"""
請根據用戶需求進行分析並生成一份教學工作表內容，學生須掌握的知識點：{learning_content}
請嚴格依據知識點所用語言，以**繁體中文**或**英語**呈現，不得使用**簡體中文**；內容需準確、專業，適合教學使用的香港書面語，請避免口語表達。
要求：
1. 內容需準確、專業並適合教學使用，請避免口語表達，嚴格依據知識點內容生成
2. 選擇題需提供合理的選項與正確答案，並按用戶需求提供多選或單選
3. 簡答題的答案要點需清晰明確
4. 學習重點需突出關鍵概念
5. 教學建議需具體且可行
6. 所有內容需與用戶需求主題相關
7. 確保JSON格式完整正確，不得有語法錯誤；特別注意轉義字元，例如反斜線在LaTeX公式中必須使用雙反斜線（\\\\）表示
8. 語言一致性（強制規則）
9. 公式使用LaTeX格式，確保數學公式清晰可讀，括號請使用\\\\left( 與 \\\\right) 等；若用戶要求包含公式考核，請在quiz_data或題目中加入相關LaTeX公式示例（如數學表達或與內容相符的相關公式）
10. 請驗證生成的JSON是否可解析，避免Invalid \\escape錯誤

請注意用戶的額外需求：{user_requirements}

請直接返回JSON格式內容，請勿添加其他說明文字。
請確保內容專業、準確，並符合教育領域的標準。

請按照以下JSON格式返回，請勿在json格式中使用中文標點符號。下列內容為示例，請根據用戶需求生成對應內容：
{{
    "theme": "文檔主題標題",
    "topic": "具體主題內容",
    "learning_focus": "學習重點內容",
    "learning_outcome": "學習成果描述",
    "teaching_suggestions": [ # 教學建議列表，可包含多項，儘量具體，避免過於籠統或簡略
        "教學建議1",
        "教學建議2", 
        "教學建議3",
        ... # 可根據需要添加更多建議
    ],
    "worksheet_title": "工作表標題",
    "quiz_data": [ # 必須為需學習掌握的知識點內容，必要時提供公式與示例
        "學習內容片段1",
        "學習內容片段2",
        "學習內容片段3",
        ... # 可根據需要添加更多內容
    ],
    "answer": "綜合答案或總結性內容",
    "multiple_choice": [ # 請根據用戶需求生成單選或多選題；題目數量可調，無需帶編號或字母
        {{
            "q": "選擇題題目1",
            "choices": ["選項A", "選項B", "選項C", "選項D", ...],
            "correct": [0, 1, 2, ...] 
        }},
        {{
            "q": "選擇題題目2",
            "choices": ["選項A", "選項B", "選項C", "選項D", ...],
            "correct": [1, 2, 3, ...]
        }},
        {{
            "q": "選擇題題目3",
            "choices": ["選項A", "選項B", "選項C", "選項D", ...],
            "correct": [0, 1, 3, ...]
        }}
    ],
    "short_answer_questions": [ # 可調整簡答題數量與內容
        {{
            "q": "簡答題題目1",
            "a": [
                "答案要點1",
                "答案要點2", 
                "答案要點3",
                "答案要點4"
            ]
        }},
        {{
            "q": "簡答題題目2",
            "a": [
                "答案要點1",
                "答案要點2",
                "答案要點3"
            ]
        }}
    ],
    "filename": "建議的文件名（不包含.docx擴展名）"
}}
"""
